<!DOCTYPE html>
<html>
<head>
	<title></title>
</head>
<body>
	<canvas id="canvas" width="800" height="600"></canvas>
	<video id="video" autoplay style="display:none;">

	</video>
	<select id="camera-selector">
		
	</select>
</body>
	<script>
		let video=document.getElementById('video');	
		let selectTag=document.getElementById('camera-selector');
		let canvas=document.getElementById('canvas');
		const context=canvas.getContext('2d');
	
		navigator.mediaDevices.enumerateDevices().then(devices=>{
			devices.forEach(device=>{
				if(device.kind != "videoinput") return;

				let optionTag=document.createElement("option");
				optionTag.innerHTML=device.label;
				optionTag.value=device.deviceId;

				selectTag.appendChild(optionTag);
			})
		})
		selectTag.addEventListener("change",function(ev){
			let deviceId=this.options[this.selectedIndex].value; //Devuelve la opcion se que haya seleccionado

			star(deviceId);
		})

		function start(deviceId=undefined){
			const constraints={
				video:{
					deviceId:deviceId
				}
			}
			navigator.mediaDevices.getUserMedia(constraints)
				.then(stream =>{
					video.srcObject=stream;
				})
				.catch(err=>console.log(err))
		}
		function loop(){ //Se ejecuta en cada fotograma
			context.drawImage(video,0,0,800,600);

			requestAnimationFrame(loop);
		}
		requestAnimationFrame(loop);
		start();

	</script>
</html>